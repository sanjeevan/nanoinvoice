{% extends 'layout.html' %}

{% block content %}

  <div class='workspace-inner'>
    <h1>Dashboard</h1>
    
    <div class="dashboard">
      <div class='card' id='graph' style='min-width: 400px; height: 240px; margin: 0 0'>
      </div>
      
      <div class='row'>
        <div class='span3'>
          <ul id='stats' class='card'>
            <li>Due:  <span class='label label-count'>{{ sent|length }}</span></li>
            <li>Draft: <span class='label label-count'>{{ send|length }}</span></li>
            <li>Overdue: <span class='label label-count'>{{ overdue|length }}</span></li>
            <li>Paid: <span class='label label-count'>0</span></li>
          </ul>
        </div>
        
        <div class='span3'>
          <div class='card'>
            <h4>Recent payments</h4>
          </div>
        </div>
        
        <div class='span3'>
          <div class='card'>
            <h4>Total <small><a href="#">Past month</a> <a href='#'>3 months</a> <a href='#'>6 months</a></small> </h4>
          </div>
        </div>
      </div>

    </div>
  </div>

  <script type="text/javascript">
    function renderChart(categories, series) {
      chart = new Highcharts.Chart({
        chart: {
          renderTo: 'graph',
          type: 'column'
        },
        title: {
          text: ''
        },
        xAxis: {
          categories: categories
        },
        yAxis: {
          min: 0,
          title: {
            text: ''
          }
        },
        plotOptions: {
          column: {
            pointPadding: 0.2,
            borderWidth: 0
          }
        },
        legend: {
          layout: 'vertical',
          backgroundColor: '#FFFFFF',
          align: 'left',
          verticalAlign: 'top',
          x: 634,
          y: 0,
          floating: true,
          shadow: false 
        },
        series: series
      });
    }

    $(document).ready(function(){
        $.ajax('{{ url_for('home.graph') }}', {
          success: function(r) {
            console.log(r);
            renderChart(r.categories, r.series);
          }
        });
    });
  </script>



{% endblock %}
