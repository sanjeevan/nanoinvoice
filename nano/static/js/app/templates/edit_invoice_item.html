<div id="edit-invoice-item" class="app-popup">
  <div class="header">Edit</div>
  <div class="content">
    <form accept-charset="utf-8" method="post" action="/frontend_dev.php/invoice_item/update" class="inline big">
      <input type="hidden" name="id" value="<%= InvoiceItem.get("id") %>" />
      <input type="hidden" name="invoice_item[invoice_id]" value="<%= InvoiceItem.get("invoice_id") %>" />
      <div class="fields">
        <div class="field">
          <label>Qty</label>
          
          <input size="2" id="quantity" type="text" name="invoice_item[quantity]" value="<%= InvoiceItem.getQuantityString() %>">

          <select id="invoice_item_type" name="invoice_item[type_id]">
            <% App.invoiceItemTypes.each(function(t) { %>
              <% if (t.get("id") == InvoiceItem.get("type_id")) { %>
                <option selected="selected" value="<%= t.get("id") %>"><%= t.get("name") %></option>
              <% } else { %> 
                <option value="<%= t.get("id") %>"><%= t.get("name") %></option>
              <% } %>
            <% }) %>
          </select>
          
          <div id="hours-help" class="help" style="display: none">
            (e.g. One and a half hours can be entered as either 1:30 or 1.5)
          </div>
        </div>
        
        <div class="field">
          <label>Details</label>
          <textarea id="details" class="wide" name="invoice_item[description]"><%= InvoiceItem.get("description") %></textarea>
        </div>

        <div class="field" id="price-row">
          <label>Unit Price (Â£)</label>
          <input id="price" type="text" name="invoice_item[price]" value="<%= InvoiceItem.get("price") %>" />
        </div>
        
        <div class="field" id="tax-row">
          <label>VAT</label>
          <select name="invoice_item[tax_rate_id]">
            <% App.taxRates.each(function(t){ %>
              <% if (InvoiceItem.get("tax_rate_id") == t.get("id")) { %>
              <option selected="selected" value="<%= t.get("id") %>"><%= t.get("name") %> (<%= t.get("rate") %>%)</option>
              <% } else { %>
              <option value="<%= t.get("id") %>"><%= t.get("name") %> (<%= t.get("rate") %>%)</option>
              <% } %>
            <% }) %> 
          </select>
        </div>

        <div class="field actions">
          <button id="save" class="button normal">Update</button> &nbsp; 
          <a href="#" class="cancel">Cancel</a>
        </div>
      </div>
    </form>
  </div>
</div>
